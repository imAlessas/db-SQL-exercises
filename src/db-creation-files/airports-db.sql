/* Author: Antonio Giunta */


DROP DATABASE IF EXISTS airports; /* Deletion of the previous version of the db */


CREATE DATABASE airports; /* Database creation */


/* Connection to the db */
\c airports


/* Creation of tables */

CREATE TABLE CITIES (
    CityName VARCHAR(20) PRIMARY KEY,
    Country CHAR(3) NOT NULL
);

CREATE TABLE AIRPLANE_TYPES (
    AircraftType VARCHAR(2) PRIMARY KEY,
    Capacity INTEGER NOT NULL
);

CREATE TABLE FLIGHTS (
    FlightId INTEGER PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
    DayOfWeek CHAR(2) NOT NULL,
    DepartureCityName VARCHAR(20) REFERENCES CITIES(CityName) NOT NULL,
    ArrivalCityName VARCHAR(20) REFERENCES CITIES(CityName) NOT NULL,
    AircraftType VARCHAR(2) REFERENCES AIRPLANE_TYPES(AircraftType)
);


/* Insertion of tuples and display .. */

/* .. of the CITIES table */
INSERT INTO CITIES VALUES ('Catania', 'ITA');

INSERT INTO CITIES VALUES ('Lyon', 'FRA');

INSERT INTO CITIES VALUES ('Milan', 'ITA');

INSERT INTO CITIES VALUES ('Paris', 'FRA');

INSERT INTO CITIES VALUES ('Rimini', 'ITA');

INSERT INTO CITIES VALUES ('Rome', 'ITA');

INSERT INTO CITIES VALUES ('Venice', 'ITA');

\qecho '\nCITIES Table'
SELECT * FROM CITIES;

/* .. of the AIRPLANE_TYPES table */
INSERT INTO AIRPLANE_TYPES VALUES ('A', 100);

INSERT INTO AIRPLANE_TYPES VALUES ('B', 70);

INSERT INTO AIRPLANE_TYPES VALUES ('C', 100);

\qecho '\nAIRPLANE_TYPES Table'
SELECT * FROM AIRPLANE_TYPES;

/* .. of the FLIGHTS table */
INSERT INTO FLIGHTS(DayOfWeek, DepartureCityName, ArrivalCityName)
  VALUES('LU', 'Rome', 'Milan'); /* Inserts: 1 in FlightId, NULL in AircraftType */

INSERT INTO FLIGHTS(DayOfWeek, DepartureCityName, ArrivalCityName, AircraftType)
    VALUES('DO', 'Paris', 'Rome', 'B');

INSERT INTO FLIGHTS(DayOfWeek, DepartureCityName, ArrivalCityName, AircraftType)
    VALUES('DO', 'Paris', 'Milan', 'B');

INSERT INTO FLIGHTS(DayOfWeek, DepartureCityName, ArrivalCityName, AircraftType)
    VALUES('DO', 'Lyon', 'Rome', 'B');

INSERT INTO FLIGHTS(DayOfWeek, DepartureCityName, ArrivalCityName, AircraftType)
    VALUES('DO', 'Rome', 'Lyon', 'B');

INSERT INTO FLIGHTS(DayOfWeek, DepartureCityName, ArrivalCityName)
  VALUES('LU', 'Milan', 'Rome');

INSERT INTO FLIGHTS(DayOfWeek, DepartureCityName, ArrivalCityName)
  VALUES('LU', 'Venice', 'Milan');

INSERT INTO FLIGHTS(DayOfWeek, DepartureCityName, ArrivalCityName)
  VALUES('LU', 'Venice', 'Milan');

INSERT INTO FLIGHTS(DayOfWeek, DepartureCityName, ArrivalCityName, AircraftType)
  VALUES('LU', 'Milan', 'Venice', 'C');

INSERT INTO FLIGHTS(DayOfWeek, DepartureCityName, ArrivalCityName)
  VALUES('DO', 'Catania', 'Milan');

INSERT INTO FLIGHTS(DayOfWeek, DepartureCityName, ArrivalCityName, AircraftType)
  VALUES('DO', 'Milan', 'Catania', 'A');

INSERT INTO FLIGHTS(DayOfWeek, DepartureCityName, ArrivalCityName, AircraftType)
  VALUES('DO', 'Milan', 'Catania', 'C');

INSERT INTO FLIGHTS(DayOfWeek, DepartureCityName, ArrivalCityName)
  VALUES('DO', 'Milan', 'Paris');

INSERT INTO FLIGHTS(DayOfWeek, DepartureCityName, ArrivalCityName)
  VALUES('LU', 'Milan', 'Paris');

INSERT INTO FLIGHTS(DayOfWeek, DepartureCityName, ArrivalCityName)
  VALUES('DO', 'Rome', 'Paris');

\qecho '\nFLIGHTS Table'
SELECT * FROM FLIGHTS;
